clear all
close all
clc

%% 
run("merge_data.m")

%% 

n = 3 + 15 * 2;         % number of state
m = 2;                  % number of control input

%% calculate the jacobian of C matrix
syms Px Py theta m1x  m1y  m2x  m2y  m3x  m3y  m4x  m4y  m5x  m5y...
                 m6x  m6y  m7x  m7y  m8x  m8y  m9x  m9y m10x m10y...
                m11x m11y m12x m12y m13x m13y m14x m14y m15x m15y real

Pt = [Px;Py];
Rotation_Matrix = [cos(theta) sin(theta); -sin(theta) cos(theta)];
g_t = [norm([m1x; m1y] - Pt);...
       atan2(Rotation_Matrix(2,:)*([m1x;m1y]-[Px;Py]), Rotation_Matrix(1,:)*([m1x;m1y]-[Px;Py]));...
       norm([m2x; m2y] - Pt);...
       atan2(Rotation_Matrix(2,:)*([m2x;m2y]-[Px;Py]), Rotation_Matrix(1,:)*([m2x;m2y]-[Px;Py]));...
       norm([m3x; m3y] - Pt);...
       atan2(Rotation_Matrix(2,:)*([m3x;m3y]-[Px;Py]), Rotation_Matrix(1,:)*([m3x;m3y]-[Px;Py]));...
       norm([m4x; m4y] - Pt);...
       atan2(Rotation_Matrix(2,:)*([m4x;m4y]-[Px;Py]), Rotation_Matrix(1,:)*([m4x;m4y]-[Px;Py]));...
       norm([m5x; m5y] - Pt);...
       atan2(Rotation_Matrix(2,:)*([m5x;m5y]-[Px;Py]), Rotation_Matrix(1,:)*([m5x;m5y]-[Px;Py]));...
       norm([m6x; m6y] - Pt);...
       atan2(Rotation_Matrix(2,:)*([m6x;m6y]-[Px;Py]), Rotation_Matrix(1,:)*([m6x;m6y]-[Px;Py]));...
       norm([m7x; m7y] - Pt);...
       atan2(Rotation_Matrix(2,:)*([m7x;m7y]-[Px;Py]), Rotation_Matrix(1,:)*([m7x;m7y]-[Px;Py]));...
       norm([m8x; m8y] - Pt);...
       atan2(Rotation_Matrix(2,:)*([m8x;m8y]-[Px;Py]), Rotation_Matrix(1,:)*([m8x;m8y]-[Px;Py]));...
       norm([m9x; m9y] - Pt);...
       atan2(Rotation_Matrix(2,:)*([m9x;m9y]-[Px;Py]), Rotation_Matrix(1,:)*([m9x;m9y]-[Px;Py]));...
       norm([m10x; m10y] - Pt);...
       atan2(Rotation_Matrix(2,:)*([m10x;m10y]-[Px;Py]), Rotation_Matrix(1,:)*([m10x;m10y]-[Px;Py]));...
       norm([m11x; m11y] - Pt);...
       atan2(Rotation_Matrix(2,:)*([m11x;m11y]-[Px;Py]), Rotation_Matrix(1,:)*([m11x;m11y]-[Px;Py]));...
       norm([m12x; m12y] - Pt);...
       atan2(Rotation_Matrix(2,:)*([m12x;m12y]-[Px;Py]), Rotation_Matrix(1,:)*([m12x;m12y]-[Px;Py]));...
       norm([m13x; m13y] - Pt);...
       atan2(Rotation_Matrix(2,:)*([m13x;m13y]-[Px;Py]), Rotation_Matrix(1,:)*([m13x;m13y]-[Px;Py]));...
       norm([m14x; m14y] - Pt);...
       atan2(Rotation_Matrix(2,:)*([m14x;m14y]-[Px;Py]), Rotation_Matrix(1,:)*([m14x;m14y]-[Px;Py]));...
       norm([m15x; m15y] - Pt);...
       atan2(Rotation_Matrix(2,:)*([m15x;m15y]-[Px;Py]), Rotation_Matrix(1,:)*([m15x;m15y]-[Px;Py]))];

x_t = [Pt; theta;  m1x;  m1y;  m2x;  m2y;  m3x;  m3y;  m4x;  m4y;  m5x;  m5y;...
                   m6x;  m6y;  m7x;  m7y;  m8x;  m8y;  m9x;  m9y; m10x; m10y;...
                  m11x; m11y; m12x; m12y; m13x; m13y; m14x; m14y; m15x; m15y];
C_t = jacobian(g_t, x_t);
C = [                                                                                                                                                                                                                                                                              (abs(Px - m1x)*sign(Px - m1x))/(abs(Px - m1x)^2 + abs(Py - m1y)^2)^(1/2),                                                                                                                                                                                                                                                                              (abs(Py - m1y)*sign(Py - m1y))/(abs(Px - m1x)^2 + abs(Py - m1y)^2)^(1/2),                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                 -(abs(Px - m1x)*sign(Px - m1x))/(abs(Px - m1x)^2 + abs(Py - m1y)^2)^(1/2),                                                                                                                                                                                                                                                                  -(abs(Py - m1y)*sign(Py - m1y))/(abs(Px - m1x)^2 + abs(Py - m1y)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
                 -((sin(theta)/(cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y)) + (cos(theta)*(cos(theta)*(Py - m1y) - sin(theta)*(Px - m1x)))/(cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y))^2)*(cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y))^2)/((cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y))^2 + (cos(theta)*(Py - m1y) - sin(theta)*(Px - m1x))^2),             ((cos(theta)/(cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y)) - (sin(theta)*(cos(theta)*(Py - m1y) - sin(theta)*(Px - m1x)))/(cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y))^2)*(cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y))^2)/((cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y))^2 + (cos(theta)*(Py - m1y) - sin(theta)*(Px - m1x))^2),           -(((cos(theta)*(Py - m1y) - sin(theta)*(Px - m1x))^2/(cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y))^2 + 1)*(cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y))^2)/((cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y))^2 + (cos(theta)*(Py - m1y) - sin(theta)*(Px - m1x))^2), ((sin(theta)/(cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y)) + (cos(theta)*(cos(theta)*(Py - m1y) - sin(theta)*(Px - m1x)))/(cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y))^2)*(cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y))^2)/((cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y))^2 + (cos(theta)*(Py - m1y) - sin(theta)*(Px - m1x))^2), -((cos(theta)/(cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y)) - (sin(theta)*(cos(theta)*(Py - m1y) - sin(theta)*(Px - m1x)))/(cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y))^2)*(cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y))^2)/((cos(theta)*(Px - m1x) + sin(theta)*(Py - m1y))^2 + (cos(theta)*(Py - m1y) - sin(theta)*(Px - m1x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
                                                                                                                                                                                                                                                                                   (abs(Px - m2x)*sign(Px - m2x))/(abs(Px - m2x)^2 + abs(Py - m2y)^2)^(1/2),                                                                                                                                                                                                                                                                              (abs(Py - m2y)*sign(Py - m2y))/(abs(Px - m2x)^2 + abs(Py - m2y)^2)^(1/2),                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                 -(abs(Px - m2x)*sign(Px - m2x))/(abs(Px - m2x)^2 + abs(Py - m2y)^2)^(1/2),                                                                                                                                                                                                                                                                  -(abs(Py - m2y)*sign(Py - m2y))/(abs(Px - m2x)^2 + abs(Py - m2y)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
                 -((sin(theta)/(cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y)) + (cos(theta)*(cos(theta)*(Py - m2y) - sin(theta)*(Px - m2x)))/(cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y))^2)*(cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y))^2)/((cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y))^2 + (cos(theta)*(Py - m2y) - sin(theta)*(Px - m2x))^2),             ((cos(theta)/(cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y)) - (sin(theta)*(cos(theta)*(Py - m2y) - sin(theta)*(Px - m2x)))/(cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y))^2)*(cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y))^2)/((cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y))^2 + (cos(theta)*(Py - m2y) - sin(theta)*(Px - m2x))^2),           -(((cos(theta)*(Py - m2y) - sin(theta)*(Px - m2x))^2/(cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y))^2 + 1)*(cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y))^2)/((cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y))^2 + (cos(theta)*(Py - m2y) - sin(theta)*(Px - m2x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0, ((sin(theta)/(cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y)) + (cos(theta)*(cos(theta)*(Py - m2y) - sin(theta)*(Px - m2x)))/(cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y))^2)*(cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y))^2)/((cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y))^2 + (cos(theta)*(Py - m2y) - sin(theta)*(Px - m2x))^2), -((cos(theta)/(cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y)) - (sin(theta)*(cos(theta)*(Py - m2y) - sin(theta)*(Px - m2x)))/(cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y))^2)*(cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y))^2)/((cos(theta)*(Px - m2x) + sin(theta)*(Py - m2y))^2 + (cos(theta)*(Py - m2y) - sin(theta)*(Px - m2x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
                                                                                                                                                                                                                                                                                   (abs(Px - m3x)*sign(Px - m3x))/(abs(Px - m3x)^2 + abs(Py - m3y)^2)^(1/2),                                                                                                                                                                                                                                                                              (abs(Py - m3y)*sign(Py - m3y))/(abs(Px - m3x)^2 + abs(Py - m3y)^2)^(1/2),                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                 -(abs(Px - m3x)*sign(Px - m3x))/(abs(Px - m3x)^2 + abs(Py - m3y)^2)^(1/2),                                                                                                                                                                                                                                                                  -(abs(Py - m3y)*sign(Py - m3y))/(abs(Px - m3x)^2 + abs(Py - m3y)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
                 -((sin(theta)/(cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y)) + (cos(theta)*(cos(theta)*(Py - m3y) - sin(theta)*(Px - m3x)))/(cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y))^2)*(cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y))^2)/((cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y))^2 + (cos(theta)*(Py - m3y) - sin(theta)*(Px - m3x))^2),             ((cos(theta)/(cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y)) - (sin(theta)*(cos(theta)*(Py - m3y) - sin(theta)*(Px - m3x)))/(cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y))^2)*(cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y))^2)/((cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y))^2 + (cos(theta)*(Py - m3y) - sin(theta)*(Px - m3x))^2),           -(((cos(theta)*(Py - m3y) - sin(theta)*(Px - m3x))^2/(cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y))^2 + 1)*(cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y))^2)/((cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y))^2 + (cos(theta)*(Py - m3y) - sin(theta)*(Px - m3x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0, ((sin(theta)/(cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y)) + (cos(theta)*(cos(theta)*(Py - m3y) - sin(theta)*(Px - m3x)))/(cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y))^2)*(cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y))^2)/((cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y))^2 + (cos(theta)*(Py - m3y) - sin(theta)*(Px - m3x))^2), -((cos(theta)/(cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y)) - (sin(theta)*(cos(theta)*(Py - m3y) - sin(theta)*(Px - m3x)))/(cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y))^2)*(cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y))^2)/((cos(theta)*(Px - m3x) + sin(theta)*(Py - m3y))^2 + (cos(theta)*(Py - m3y) - sin(theta)*(Px - m3x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
                                                                                                                                                                                                                                                                                   (abs(Px - m4x)*sign(Px - m4x))/(abs(Px - m4x)^2 + abs(Py - m4y)^2)^(1/2),                                                                                                                                                                                                                                                                              (abs(Py - m4y)*sign(Py - m4y))/(abs(Px - m4x)^2 + abs(Py - m4y)^2)^(1/2),                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                 -(abs(Px - m4x)*sign(Px - m4x))/(abs(Px - m4x)^2 + abs(Py - m4y)^2)^(1/2),                                                                                                                                                                                                                                                                  -(abs(Py - m4y)*sign(Py - m4y))/(abs(Px - m4x)^2 + abs(Py - m4y)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
                 -((sin(theta)/(cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y)) + (cos(theta)*(cos(theta)*(Py - m4y) - sin(theta)*(Px - m4x)))/(cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y))^2)*(cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y))^2)/((cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y))^2 + (cos(theta)*(Py - m4y) - sin(theta)*(Px - m4x))^2),             ((cos(theta)/(cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y)) - (sin(theta)*(cos(theta)*(Py - m4y) - sin(theta)*(Px - m4x)))/(cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y))^2)*(cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y))^2)/((cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y))^2 + (cos(theta)*(Py - m4y) - sin(theta)*(Px - m4x))^2),           -(((cos(theta)*(Py - m4y) - sin(theta)*(Px - m4x))^2/(cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y))^2 + 1)*(cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y))^2)/((cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y))^2 + (cos(theta)*(Py - m4y) - sin(theta)*(Px - m4x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0, ((sin(theta)/(cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y)) + (cos(theta)*(cos(theta)*(Py - m4y) - sin(theta)*(Px - m4x)))/(cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y))^2)*(cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y))^2)/((cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y))^2 + (cos(theta)*(Py - m4y) - sin(theta)*(Px - m4x))^2), -((cos(theta)/(cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y)) - (sin(theta)*(cos(theta)*(Py - m4y) - sin(theta)*(Px - m4x)))/(cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y))^2)*(cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y))^2)/((cos(theta)*(Px - m4x) + sin(theta)*(Py - m4y))^2 + (cos(theta)*(Py - m4y) - sin(theta)*(Px - m4x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
                                                                                                                                                                                                                                                                                   (abs(Px - m5x)*sign(Px - m5x))/(abs(Px - m5x)^2 + abs(Py - m5y)^2)^(1/2),                                                                                                                                                                                                                                                                              (abs(Py - m5y)*sign(Py - m5y))/(abs(Px - m5x)^2 + abs(Py - m5y)^2)^(1/2),                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                 -(abs(Px - m5x)*sign(Px - m5x))/(abs(Px - m5x)^2 + abs(Py - m5y)^2)^(1/2),                                                                                                                                                                                                                                                                  -(abs(Py - m5y)*sign(Py - m5y))/(abs(Px - m5x)^2 + abs(Py - m5y)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
                 -((sin(theta)/(cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y)) + (cos(theta)*(cos(theta)*(Py - m5y) - sin(theta)*(Px - m5x)))/(cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y))^2)*(cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y))^2)/((cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y))^2 + (cos(theta)*(Py - m5y) - sin(theta)*(Px - m5x))^2),             ((cos(theta)/(cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y)) - (sin(theta)*(cos(theta)*(Py - m5y) - sin(theta)*(Px - m5x)))/(cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y))^2)*(cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y))^2)/((cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y))^2 + (cos(theta)*(Py - m5y) - sin(theta)*(Px - m5x))^2),           -(((cos(theta)*(Py - m5y) - sin(theta)*(Px - m5x))^2/(cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y))^2 + 1)*(cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y))^2)/((cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y))^2 + (cos(theta)*(Py - m5y) - sin(theta)*(Px - m5x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0, ((sin(theta)/(cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y)) + (cos(theta)*(cos(theta)*(Py - m5y) - sin(theta)*(Px - m5x)))/(cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y))^2)*(cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y))^2)/((cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y))^2 + (cos(theta)*(Py - m5y) - sin(theta)*(Px - m5x))^2), -((cos(theta)/(cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y)) - (sin(theta)*(cos(theta)*(Py - m5y) - sin(theta)*(Px - m5x)))/(cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y))^2)*(cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y))^2)/((cos(theta)*(Px - m5x) + sin(theta)*(Py - m5y))^2 + (cos(theta)*(Py - m5y) - sin(theta)*(Px - m5x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
                                                                                                                                                                                                                                                                                   (abs(Px - m6x)*sign(Px - m6x))/(abs(Px - m6x)^2 + abs(Py - m6y)^2)^(1/2),                                                                                                                                                                                                                                                                              (abs(Py - m6y)*sign(Py - m6y))/(abs(Px - m6x)^2 + abs(Py - m6y)^2)^(1/2),                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                 -(abs(Px - m6x)*sign(Px - m6x))/(abs(Px - m6x)^2 + abs(Py - m6y)^2)^(1/2),                                                                                                                                                                                                                                                                  -(abs(Py - m6y)*sign(Py - m6y))/(abs(Px - m6x)^2 + abs(Py - m6y)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
                 -((sin(theta)/(cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y)) + (cos(theta)*(cos(theta)*(Py - m6y) - sin(theta)*(Px - m6x)))/(cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y))^2)*(cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y))^2)/((cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y))^2 + (cos(theta)*(Py - m6y) - sin(theta)*(Px - m6x))^2),             ((cos(theta)/(cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y)) - (sin(theta)*(cos(theta)*(Py - m6y) - sin(theta)*(Px - m6x)))/(cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y))^2)*(cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y))^2)/((cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y))^2 + (cos(theta)*(Py - m6y) - sin(theta)*(Px - m6x))^2),           -(((cos(theta)*(Py - m6y) - sin(theta)*(Px - m6x))^2/(cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y))^2 + 1)*(cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y))^2)/((cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y))^2 + (cos(theta)*(Py - m6y) - sin(theta)*(Px - m6x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0, ((sin(theta)/(cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y)) + (cos(theta)*(cos(theta)*(Py - m6y) - sin(theta)*(Px - m6x)))/(cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y))^2)*(cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y))^2)/((cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y))^2 + (cos(theta)*(Py - m6y) - sin(theta)*(Px - m6x))^2), -((cos(theta)/(cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y)) - (sin(theta)*(cos(theta)*(Py - m6y) - sin(theta)*(Px - m6x)))/(cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y))^2)*(cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y))^2)/((cos(theta)*(Px - m6x) + sin(theta)*(Py - m6y))^2 + (cos(theta)*(Py - m6y) - sin(theta)*(Px - m6x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
                                                                                                                                                                                                                                                                                    (abs(Px - m7x)*sign(Px - m7x))/(abs(Px - m7x)^2 + abs(Py - m7y)^2)^(1/2),                                                                                                                                                                                                                                                                              (abs(Py - m7y)*sign(Py - m7y))/(abs(Px - m7x)^2 + abs(Py - m7y)^2)^(1/2),                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                 -(abs(Px - m7x)*sign(Px - m7x))/(abs(Px - m7x)^2 + abs(Py - m7y)^2)^(1/2),                                                                                                                                                                                                                                                                  -(abs(Py - m7y)*sign(Py - m7y))/(abs(Px - m7x)^2 + abs(Py - m7y)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
                 -((sin(theta)/(cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y)) + (cos(theta)*(cos(theta)*(Py - m7y) - sin(theta)*(Px - m7x)))/(cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y))^2)*(cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y))^2)/((cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y))^2 + (cos(theta)*(Py - m7y) - sin(theta)*(Px - m7x))^2),             ((cos(theta)/(cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y)) - (sin(theta)*(cos(theta)*(Py - m7y) - sin(theta)*(Px - m7x)))/(cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y))^2)*(cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y))^2)/((cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y))^2 + (cos(theta)*(Py - m7y) - sin(theta)*(Px - m7x))^2),           -(((cos(theta)*(Py - m7y) - sin(theta)*(Px - m7x))^2/(cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y))^2 + 1)*(cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y))^2)/((cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y))^2 + (cos(theta)*(Py - m7y) - sin(theta)*(Px - m7x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0, ((sin(theta)/(cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y)) + (cos(theta)*(cos(theta)*(Py - m7y) - sin(theta)*(Px - m7x)))/(cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y))^2)*(cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y))^2)/((cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y))^2 + (cos(theta)*(Py - m7y) - sin(theta)*(Px - m7x))^2), -((cos(theta)/(cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y)) - (sin(theta)*(cos(theta)*(Py - m7y) - sin(theta)*(Px - m7x)))/(cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y))^2)*(cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y))^2)/((cos(theta)*(Px - m7x) + sin(theta)*(Py - m7y))^2 + (cos(theta)*(Py - m7y) - sin(theta)*(Px - m7x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
                                                                                                                                                                                                                                                                                   (abs(Px - m8x)*sign(Px - m8x))/(abs(Px - m8x)^2 + abs(Py - m8y)^2)^(1/2),                                                                                                                                                                                                                                                                              (abs(Py - m8y)*sign(Py - m8y))/(abs(Px - m8x)^2 + abs(Py - m8y)^2)^(1/2),                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                 -(abs(Px - m8x)*sign(Px - m8x))/(abs(Px - m8x)^2 + abs(Py - m8y)^2)^(1/2),                                                                                                                                                                                                                                                                  -(abs(Py - m8y)*sign(Py - m8y))/(abs(Px - m8x)^2 + abs(Py - m8y)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
                 -((sin(theta)/(cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y)) + (cos(theta)*(cos(theta)*(Py - m8y) - sin(theta)*(Px - m8x)))/(cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y))^2)*(cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y))^2)/((cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y))^2 + (cos(theta)*(Py - m8y) - sin(theta)*(Px - m8x))^2),             ((cos(theta)/(cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y)) - (sin(theta)*(cos(theta)*(Py - m8y) - sin(theta)*(Px - m8x)))/(cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y))^2)*(cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y))^2)/((cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y))^2 + (cos(theta)*(Py - m8y) - sin(theta)*(Px - m8x))^2),           -(((cos(theta)*(Py - m8y) - sin(theta)*(Px - m8x))^2/(cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y))^2 + 1)*(cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y))^2)/((cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y))^2 + (cos(theta)*(Py - m8y) - sin(theta)*(Px - m8x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0, ((sin(theta)/(cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y)) + (cos(theta)*(cos(theta)*(Py - m8y) - sin(theta)*(Px - m8x)))/(cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y))^2)*(cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y))^2)/((cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y))^2 + (cos(theta)*(Py - m8y) - sin(theta)*(Px - m8x))^2), -((cos(theta)/(cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y)) - (sin(theta)*(cos(theta)*(Py - m8y) - sin(theta)*(Px - m8x)))/(cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y))^2)*(cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y))^2)/((cos(theta)*(Px - m8x) + sin(theta)*(Py - m8y))^2 + (cos(theta)*(Py - m8y) - sin(theta)*(Px - m8x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
                                                                                                                                                                                                                                                                                   (abs(Px - m9x)*sign(Px - m9x))/(abs(Px - m9x)^2 + abs(Py - m9y)^2)^(1/2),                                                                                                                                                                                                                                                                              (abs(Py - m9y)*sign(Py - m9y))/(abs(Px - m9x)^2 + abs(Py - m9y)^2)^(1/2),                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                 -(abs(Px - m9x)*sign(Px - m9x))/(abs(Px - m9x)^2 + abs(Py - m9y)^2)^(1/2),                                                                                                                                                                                                                                                                  -(abs(Py - m9y)*sign(Py - m9y))/(abs(Px - m9x)^2 + abs(Py - m9y)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
                 -((sin(theta)/(cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y)) + (cos(theta)*(cos(theta)*(Py - m9y) - sin(theta)*(Px - m9x)))/(cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y))^2)*(cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y))^2)/((cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y))^2 + (cos(theta)*(Py - m9y) - sin(theta)*(Px - m9x))^2),             ((cos(theta)/(cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y)) - (sin(theta)*(cos(theta)*(Py - m9y) - sin(theta)*(Px - m9x)))/(cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y))^2)*(cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y))^2)/((cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y))^2 + (cos(theta)*(Py - m9y) - sin(theta)*(Px - m9x))^2),           -(((cos(theta)*(Py - m9y) - sin(theta)*(Px - m9x))^2/(cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y))^2 + 1)*(cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y))^2)/((cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y))^2 + (cos(theta)*(Py - m9y) - sin(theta)*(Px - m9x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0, ((sin(theta)/(cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y)) + (cos(theta)*(cos(theta)*(Py - m9y) - sin(theta)*(Px - m9x)))/(cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y))^2)*(cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y))^2)/((cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y))^2 + (cos(theta)*(Py - m9y) - sin(theta)*(Px - m9x))^2), -((cos(theta)/(cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y)) - (sin(theta)*(cos(theta)*(Py - m9y) - sin(theta)*(Px - m9x)))/(cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y))^2)*(cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y))^2)/((cos(theta)*(Px - m9x) + sin(theta)*(Py - m9y))^2 + (cos(theta)*(Py - m9y) - sin(theta)*(Px - m9x))^2),                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
                                                                                                                                                                                                                                                                               (abs(Px - m10x)*sign(Px - m10x))/(abs(Px - m10x)^2 + abs(Py - m10y)^2)^(1/2),                                                                                                                                                                                                                                                                          (abs(Py - m10y)*sign(Py - m10y))/(abs(Px - m10x)^2 + abs(Py - m10y)^2)^(1/2),                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                         -(abs(Px - m10x)*sign(Px - m10x))/(abs(Px - m10x)^2 + abs(Py - m10y)^2)^(1/2),                                                                                                                                                                                                                                                                          -(abs(Py - m10y)*sign(Py - m10y))/(abs(Px - m10x)^2 + abs(Py - m10y)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
    [-((sin(theta)/(cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y)) + (cos(theta)*(cos(theta)*(Py - m10y) - sin(theta)*(Px - m10x)))/(cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y))^2)*(cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y))^2)/((cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y))^2 + (cos(theta)*(Py - m10y) - sin(theta)*(Px - m10x))^2), ((cos(theta)/(cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y)) - (sin(theta)*(cos(theta)*(Py - m10y) - sin(theta)*(Px - m10x)))/(cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y))^2)*(cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y))^2)/((cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y))^2 + (cos(theta)*(Py - m10y) - sin(theta)*(Px - m10x))^2), -(((cos(theta)*(Py - m10y) - sin(theta)*(Px - m10x))^2/(cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y))^2 + 1)*(cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y))^2)/((cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y))^2 + (cos(theta)*(Py - m10y) - sin(theta)*(Px - m10x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0, ((sin(theta)/(cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y)) + (cos(theta)*(cos(theta)*(Py - m10y) - sin(theta)*(Px - m10x)))/(cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y))^2)*(cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y))^2)/((cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y))^2 + (cos(theta)*(Py - m10y) - sin(theta)*(Px - m10x))^2), -((cos(theta)/(cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y)) - (sin(theta)*(cos(theta)*(Py - m10y) - sin(theta)*(Px - m10x)))/(cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y))^2)*(cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y))^2)/((cos(theta)*(Px - m10x) + sin(theta)*(Py - m10y))^2 + (cos(theta)*(Py - m10y) - sin(theta)*(Px - m10x))^2),                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
    [                                                                                                                                                                                                                                                                          (abs(Px - m11x)*sign(Px - m11x))/(abs(Px - m11x)^2 + abs(Py - m11y)^2)^(1/2),                                                                                                                                                                                                                                                                          (abs(Py - m11y)*sign(Py - m11y))/(abs(Px - m11x)^2 + abs(Py - m11y)^2)^(1/2),                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                         -(abs(Px - m11x)*sign(Px - m11x))/(abs(Px - m11x)^2 + abs(Py - m11y)^2)^(1/2),                                                                                                                                                                                                                                                                          -(abs(Py - m11y)*sign(Py - m11y))/(abs(Px - m11x)^2 + abs(Py - m11y)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
    [-((sin(theta)/(cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y)) + (cos(theta)*(cos(theta)*(Py - m11y) - sin(theta)*(Px - m11x)))/(cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y))^2)*(cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y))^2)/((cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y))^2 + (cos(theta)*(Py - m11y) - sin(theta)*(Px - m11x))^2), ((cos(theta)/(cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y)) - (sin(theta)*(cos(theta)*(Py - m11y) - sin(theta)*(Px - m11x)))/(cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y))^2)*(cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y))^2)/((cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y))^2 + (cos(theta)*(Py - m11y) - sin(theta)*(Px - m11x))^2), -(((cos(theta)*(Py - m11y) - sin(theta)*(Px - m11x))^2/(cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y))^2 + 1)*(cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y))^2)/((cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y))^2 + (cos(theta)*(Py - m11y) - sin(theta)*(Px - m11x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0, ((sin(theta)/(cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y)) + (cos(theta)*(cos(theta)*(Py - m11y) - sin(theta)*(Px - m11x)))/(cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y))^2)*(cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y))^2)/((cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y))^2 + (cos(theta)*(Py - m11y) - sin(theta)*(Px - m11x))^2), -((cos(theta)/(cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y)) - (sin(theta)*(cos(theta)*(Py - m11y) - sin(theta)*(Px - m11x)))/(cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y))^2)*(cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y))^2)/((cos(theta)*(Px - m11x) + sin(theta)*(Py - m11y))^2 + (cos(theta)*(Py - m11y) - sin(theta)*(Px - m11x))^2),                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
    [                                                                                                                                                                                                                                                                          (abs(Px - m12x)*sign(Px - m12x))/(abs(Px - m12x)^2 + abs(Py - m12y)^2)^(1/2),                                                                                                                                                                                                                                                                          (abs(Py - m12y)*sign(Py - m12y))/(abs(Px - m12x)^2 + abs(Py - m12y)^2)^(1/2),                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                         -(abs(Px - m12x)*sign(Px - m12x))/(abs(Px - m12x)^2 + abs(Py - m12y)^2)^(1/2),                                                                                                                                                                                                                                                                          -(abs(Py - m12y)*sign(Py - m12y))/(abs(Px - m12x)^2 + abs(Py - m12y)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
    [-((sin(theta)/(cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y)) + (cos(theta)*(cos(theta)*(Py - m12y) - sin(theta)*(Px - m12x)))/(cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y))^2)*(cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y))^2)/((cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y))^2 + (cos(theta)*(Py - m12y) - sin(theta)*(Px - m12x))^2), ((cos(theta)/(cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y)) - (sin(theta)*(cos(theta)*(Py - m12y) - sin(theta)*(Px - m12x)))/(cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y))^2)*(cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y))^2)/((cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y))^2 + (cos(theta)*(Py - m12y) - sin(theta)*(Px - m12x))^2), -(((cos(theta)*(Py - m12y) - sin(theta)*(Px - m12x))^2/(cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y))^2 + 1)*(cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y))^2)/((cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y))^2 + (cos(theta)*(Py - m12y) - sin(theta)*(Px - m12x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0, ((sin(theta)/(cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y)) + (cos(theta)*(cos(theta)*(Py - m12y) - sin(theta)*(Px - m12x)))/(cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y))^2)*(cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y))^2)/((cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y))^2 + (cos(theta)*(Py - m12y) - sin(theta)*(Px - m12x))^2), -((cos(theta)/(cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y)) - (sin(theta)*(cos(theta)*(Py - m12y) - sin(theta)*(Px - m12x)))/(cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y))^2)*(cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y))^2)/((cos(theta)*(Px - m12x) + sin(theta)*(Py - m12y))^2 + (cos(theta)*(Py - m12y) - sin(theta)*(Px - m12x))^2),                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
    [                                                                                                                                                                                                                                                                          (abs(Px - m13x)*sign(Px - m13x))/(abs(Px - m13x)^2 + abs(Py - m13y)^2)^(1/2),                                                                                                                                                                                                                                                                          (abs(Py - m13y)*sign(Py - m13y))/(abs(Px - m13x)^2 + abs(Py - m13y)^2)^(1/2),                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                         -(abs(Px - m13x)*sign(Px - m13x))/(abs(Px - m13x)^2 + abs(Py - m13y)^2)^(1/2),                                                                                                                                                                                                                                                                          -(abs(Py - m13y)*sign(Py - m13y))/(abs(Px - m13x)^2 + abs(Py - m13y)^2)^(1/2),                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
    [-((sin(theta)/(cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y)) + (cos(theta)*(cos(theta)*(Py - m13y) - sin(theta)*(Px - m13x)))/(cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y))^2)*(cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y))^2)/((cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y))^2 + (cos(theta)*(Py - m13y) - sin(theta)*(Px - m13x))^2), ((cos(theta)/(cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y)) - (sin(theta)*(cos(theta)*(Py - m13y) - sin(theta)*(Px - m13x)))/(cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y))^2)*(cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y))^2)/((cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y))^2 + (cos(theta)*(Py - m13y) - sin(theta)*(Px - m13x))^2), -(((cos(theta)*(Py - m13y) - sin(theta)*(Px - m13x))^2/(cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y))^2 + 1)*(cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y))^2)/((cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y))^2 + (cos(theta)*(Py - m13y) - sin(theta)*(Px - m13x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0, ((sin(theta)/(cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y)) + (cos(theta)*(cos(theta)*(Py - m13y) - sin(theta)*(Px - m13x)))/(cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y))^2)*(cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y))^2)/((cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y))^2 + (cos(theta)*(Py - m13y) - sin(theta)*(Px - m13x))^2), -((cos(theta)/(cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y)) - (sin(theta)*(cos(theta)*(Py - m13y) - sin(theta)*(Px - m13x)))/(cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y))^2)*(cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y))^2)/((cos(theta)*(Px - m13x) + sin(theta)*(Py - m13y))^2 + (cos(theta)*(Py - m13y) - sin(theta)*(Px - m13x))^2),                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
    [                                                                                                                                                                                                                                                                          (abs(Px - m14x)*sign(Px - m14x))/(abs(Px - m14x)^2 + abs(Py - m14y)^2)^(1/2),                                                                                                                                                                                                                                                                          (abs(Py - m14y)*sign(Py - m14y))/(abs(Px - m14x)^2 + abs(Py - m14y)^2)^(1/2),                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                         -(abs(Px - m14x)*sign(Px - m14x))/(abs(Px - m14x)^2 + abs(Py - m14y)^2)^(1/2),                                                                                                                                                                                                                                                                          -(abs(Py - m14y)*sign(Py - m14y))/(abs(Px - m14x)^2 + abs(Py - m14y)^2)^(1/2)                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
    [-((sin(theta)/(cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y)) + (cos(theta)*(cos(theta)*(Py - m14y) - sin(theta)*(Px - m14x)))/(cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y))^2)*(cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y))^2)/((cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y))^2 + (cos(theta)*(Py - m14y) - sin(theta)*(Px - m14x))^2), ((cos(theta)/(cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y)) - (sin(theta)*(cos(theta)*(Py - m14y) - sin(theta)*(Px - m14x)))/(cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y))^2)*(cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y))^2)/((cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y))^2 + (cos(theta)*(Py - m14y) - sin(theta)*(Px - m14x))^2), -(((cos(theta)*(Py - m14y) - sin(theta)*(Px - m14x))^2/(cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y))^2 + 1)*(cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y))^2)/((cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y))^2 + (cos(theta)*(Py - m14y) - sin(theta)*(Px - m14x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0, ((sin(theta)/(cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y)) + (cos(theta)*(cos(theta)*(Py - m14y) - sin(theta)*(Px - m14x)))/(cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y))^2)*(cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y))^2)/((cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y))^2 + (cos(theta)*(Py - m14y) - sin(theta)*(Px - m14x))^2), -((cos(theta)/(cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y)) - (sin(theta)*(cos(theta)*(Py - m14y) - sin(theta)*(Px - m14x)))/(cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y))^2)*(cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y))^2)/((cos(theta)*(Px - m14x) + sin(theta)*(Py - m14y))^2 + (cos(theta)*(Py - m14y) - sin(theta)*(Px - m14x))^2)                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                      0;...
    [                                                                                                                                                                                                                                                                          (abs(Px - m15x)*sign(Px - m15x))/(abs(Px - m15x)^2 + abs(Py - m15y)^2)^(1/2),                                                                                                                                                                                                                                                                          (abs(Py - m15y)*sign(Py - m15y))/(abs(Px - m15x)^2 + abs(Py - m15y)^2)^(1/2),                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                         -(abs(Px - m15x)*sign(Px - m15x))/(abs(Px - m15x)^2 + abs(Py - m15y)^2)^(1/2)                                                                                                                                                                                                                                                                          -(abs(Py - m15y)*sign(Py - m15y))/(abs(Px - m15x)^2 + abs(Py - m15y)^2)^(1/2);...
    [-((sin(theta)/(cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y)) + (cos(theta)*(cos(theta)*(Py - m15y) - sin(theta)*(Px - m15x)))/(cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y))^2)*(cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y))^2)/((cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y))^2 + (cos(theta)*(Py - m15y) - sin(theta)*(Px - m15x))^2), ((cos(theta)/(cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y)) - (sin(theta)*(cos(theta)*(Py - m15y) - sin(theta)*(Px - m15x)))/(cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y))^2)*(cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y))^2)/((cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y))^2 + (cos(theta)*(Py - m15y) - sin(theta)*(Px - m15x))^2), -(((cos(theta)*(Py - m15y) - sin(theta)*(Px - m15x))^2/(cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y))^2 + 1)*(cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y))^2)/((cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y))^2 + (cos(theta)*(Py - m15y) - sin(theta)*(Px - m15x))^2),                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                      0 ((sin(theta)/(cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y)) + (cos(theta)*(cos(theta)*(Py - m15y) - sin(theta)*(Px - m15x)))/(cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y))^2)*(cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y))^2)/((cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y))^2 + (cos(theta)*(Py - m15y) - sin(theta)*(Px - m15x))^2) -((cos(theta)/(cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y)) - (sin(theta)*(cos(theta)*(Py - m15y) - sin(theta)*(Px - m15x)))/(cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y))^2)*(cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y))^2)/((cos(theta)*(Px - m15x) + sin(theta)*(Py - m15y))^2 + (cos(theta)*(Py - m15y) - sin(theta)*(Px - m15x))^2)];
     

%% implement EKF
% simulate the first 50000 rows (approx. 725 sec)

simTime = 50000;
initial_pose = Robot1_Groundtruth(350, 2:4);
initial_guess_landmarks = zeros(1,30);

mu_EKF = NaN(simTime,n);  
mu_EKF(1,:) = [initial_pose initial_guess_landmarks];       

sigma_EKF = NaN(n*simTime,n);
sigma_EKF(1:n, 1:n) = 7*eye(n);         % initialize sigma_0|0 as 7I

% observable = zeros(simTime-1,1);
% controllable = zeros(simTime-1,1);

i = 1;      % simulation starts at the first row(time step) of control input 

% flag_feature = 6:20;

while i < simTime
    
    dt = round( Robot(i+1,1) - Robot(i,1), 3 );         % rounded
    j = i + 1;
    y = [];

    % import measurement data, if there is any
    if Robot(j,2) == 1
        while Robot(j+1,2) == 1 
            j = j + 1;
        end
        for k = i+1:j
%             if ismember(Robot(k,3), flag_feature)
               y = [y; Robot(k,3:5)];
%             end
        end
    end

    % PREDICTION
    mu_pred = [mu_EKF(i,1)+dt*Robot(i,3)*cos(mu_EKF(i,3)) ...
               mu_EKF(i,2)+dt*Robot(i,3)*sin(mu_EKF(i,3)) ...
               mu_EKF(i,3)+dt*Robot(i,4) ...
               mu_EKF(i,4) ...
               mu_EKF(i,5) ...
               mu_EKF(i,6) ...
               mu_EKF(i,7) ...
               mu_EKF(i,8) ...
               mu_EKF(i,9) ...
               mu_EKF(i,10) ...
               mu_EKF(i,11) ...
               mu_EKF(i,12) ...
               mu_EKF(i,13) ...
               mu_EKF(i,14) ...
               mu_EKF(i,15) ...
               mu_EKF(i,16) ...
               mu_EKF(i,17) ...
               mu_EKF(i,18) ...
               mu_EKF(i,19) ...
               mu_EKF(i,20) ...
               mu_EKF(i,21) ...
               mu_EKF(i,22) ...
               mu_EKF(i,23) ...
               mu_EKF(i,24) ...
               mu_EKF(i,25) ...
               mu_EKF(i,26) ...
               mu_EKF(i,27) ...
               mu_EKF(i,28) ...
               mu_EKF(i,29) ...
               mu_EKF(i,30) ...
               mu_EKF(i,31) ...
               mu_EKF(i,32) ...
               mu_EKF(i,33)];
    
    A_pose_part = [1 0 -dt*Robot(i,3)*sin(mu_EKF(i,3));...
                   0 1  dt*Robot(i,3)*cos(mu_EKF(i,3));...
                   0 0                 1];
    A_landmark_part = eye(30);

    A = [A_pose_part  zeros(3,30);...
         zeros(30,3)  A_landmark_part];

    Q = [Q1 zeros(3,30); zeros(30,3) 0.01*eye(30)]; 
    % NOT SURE if I can do this. 
    % Basically saying that there is cross covariance between each pose
    % state, but the distribution of each landmark position is independent
    % with all other states.
    % If we cannot do this operation, it probably means that we might not
    % be able to recover the original map. 

    sigma_pred = A * sigma_EKF(n*i-n+1:n*i,:) * A' + Q;

    % UPDATE
%     Px = mu_pred(1); Py = mu_pred(2);
%     m1x = mu_pred(4); m1y = mu_pred(5);
%     m2x = mu_pred(6); m2y = mu_pred(7);
%     m3x = mu_pred(8); m3y = mu_pred(9);
%     m4x = mu_pred(10); m4y = mu_pred(11);

    if ~isempty(y)

        % The dimension of C would change over time (waiting for answer on Ed)
%         C = [];
        K = sigma_pred * C' / (C*sigma_pred*C' + R);
%         g = [];
    
        mu_EKF(i+1,:) = mu_pred + K * (y - g);
        sigma_EKF(n*i+1:n*i+n,:) = sigma_pred - K * C * sigma_pred;
        % Go to OH and ask, how can we update the covariance matrix with
        % finite measurement. (mu is relatively easy)
    else
        mu_EKF(i+1,:) = mu_pred;
        sigma_EKF(n*i+1:n*i+n,:) = sigma_pred;
    end

%     % check observability matrix
%     observability_matrix = [C; C*A; C*A*A];
%     if rank(observability_matrix) == n
%         observable(i) = 1;
%     end
% 
%     % check controllability matrix
%     controllability_matrix = [chol(Q) A*chol(Q) A*A*chol(Q)];
%     if rank(controllability_matrix) == n
%         controllable(i) = 1;
%     end

    i = j + 1;
end 

mu_EKF = rmmissing(mu_EKF, 1);
sigma_EKF = rmmissing(sigma_EKF, 1);
